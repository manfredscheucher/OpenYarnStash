package org.example.project.pdf\n\nimport androidx.compose.runtime.Composable\nimport androidx.compose.runtime.remember\nimport kotlinx.cinterop.memScoped\nimport kotlinx.cinterop.refTo\nimport platform.Foundation.NSData\nimport platform.Foundation.create\nimport platform.UIKit.UIActivityViewController\nimport platform.UIKit.UIApplication\nimport platform.UIKit.UIWindow\n\n@Composable\nactual fun rememberPdfSaver(): (fileName: String, data: ByteArray) -> Unit {\n    val window = UIApplication.sharedApplication.windows.lastOrNull() as? UIWindow\n\n    return remember(window) {\n        { fileName, data ->\n            window?.rootViewController?.let {\ rootViewController ->\n                val nsData = memScoped {\n                    NSData.create(bytes = data.refTo(0), length = data.size.toULong())\n                }\n                val activityViewController = UIActivityViewController(listOf(nsData), null)\n\n                var topController = rootViewController\n                while (topController.presentedViewController != null) {\n                    topController = topController.presentedViewController!!\n                }\n                topController.presentViewController(activityViewController, true, null)\n            }\n        }\n    }\n}\n